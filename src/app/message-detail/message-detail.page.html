<!-- Search Status by "Status is" and then status Name -->
<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-back-button defaultHref="home/tabs/messages" (click)="goToMessages()"></ion-back-button>
        </ion-buttons>
        <ion-title>{{onlyProfile? 'Booking Detail' : 'Message Detail'}}</ion-title>

    </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

    <ng-container *ngIf="isAPILoaded">
        <ion-segment [(ngModel)]="selectedSegment" *ngIf="!onlyProfile" color="theme">
            <ion-segment-button class="ion-text-capitalize" value="bookingAssistant">Booking
                Assistant</ion-segment-button>
            <ion-segment-button class="ion-text-capitalize" value="info">My Booking</ion-segment-button>
        </ion-segment>


        <div [ngSwitch]="selectedSegment">
            <div *ngSwitchCase="'info'">
                <ion-grid class="profile">
                    <ion-row *ngIf="userId == messageMinderId" (click)="redirectProfile()">
                        <ion-col class="avatar-col">
                            <ion-avatar [routerLink]="['/pet-sitter-detail', messageOwnerId]">
                                <ion-img [src]="messageDetails?.owner?.imagename == '' || 
                                messageDetails?.owner?.imagename == null  ? 
                                '../../assets/icon/user.png' 
                                : messageDetails?.owner?.imagename"></ion-img>
                            </ion-avatar>
                        </ion-col>
                    </ion-row>

                    <ion-row *ngIf="userId == messageOwnerId" (click)="redirectProfile()">
                        <ion-col class="avatar-col">
                            <ion-avatar [routerLink]="['/pet-sitter-detail', messageMinderId]">
                                <ion-img [src]="messageDetails?.minder?.imagename == '' || 
                                messageDetails?.minder?.imagename == null  ? 
                                '../../assets/icon/user.png' 
                                : messageDetails?.minder?.imagename"></ion-img>
                            </ion-avatar>
                        </ion-col>

                    </ion-row>

                    <ion-row (click)="redirectProfile()">
                        <ion-col [routerLink]="['/pet-sitter-detail', messageMinderId]"
                            *ngIf="userId == messageOwnerId">
                            <h4 class="profile-name">{{messageDetails?.minder?.first_name}}</h4>
                        </ion-col>
                        <ion-col [routerLink]="['/pet-sitter-detail', messageOwnerId]"
                            *ngIf="userId == messageMinderId">
                            <h4 class="profile-name">{{messageDetails?.owner?.first_name}}</h4>
                        </ion-col>
                    </ion-row>

                    <!--ion-row (click)="redirectProfile()">
                        <ion-col [routerLink]="['/pet-sitter-detail', messageOwnerId]">
                            <h4 class="profile-name">{{message?.owner?.first_name}}</h4>
                        </ion-col>
                    </ion-row-->


                </ion-grid>

                <div class="info-list">

                    <div class="info-item info-row">
                        <div class="info-label">
                            <h4> Booking Id</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{chatBookingId}}</p>
                        </div>
                    </div>

                    <div *ngIf="userId == messageMinderId" class="info-item info-row">
                        <div class="info-label">
                            <h4> Suburb</h4>
                        </div>
                        <div class="info-desc">
                            <p class="profile-contact">{{
                                (messageDetails?.booking_status == 'MD'
                                || messageDetails?.booking_status == 'M'
                                || messageDetails?.booking_status == 'CURR')
                                ? (messageDetails?.owner?.address)
                                : 'XXXX XXX XXX' }}
                            </p>
                        </div>
                    </div>




                    <div *ngIf="userId == messageMinderId" class="info-item info-row">
                        <div class="info-label">
                            <h4> Mobile</h4>
                        </div>
                        <div class="info-desc">
                            <p *ngIf="messageDetails?.booking_status == 'MD' 
                            || messageDetails?.booking_status == 'M'
                            || messageDetails?.booking_status == 'A'
                            || messageDetails?.booking_status == 'CURR'">

                                <span class="highlight" (click)="makeCall(messageDetails.minder.mobile)">
                                    {{messageDetails?.minder?.mobile}}
                                </span>

                            <p *ngIf="messageDetails?.booking_status == 'E' 
                                || messageDetails?.booking_status == 'C'
                                || messageDetails?.booking_status == 'P'
                                || messageDetails?.booking_status == 'D' 
                                || messageDetails?.booking_status == 'CAN'
                                || messageDetails?.booking_status == 'PP'
                                || messageDetails?.booking_status == 'L'
                                || messageDetails?.booking_status == 'RA'
                                || messageDetails?.booking_status == 'R'
                                || messageDetails?.booking_status == 'J'
                                || messageDetails?.booking_status == 'NA'
                                || messageDetails?.booking_status == 'NC'">
                                <span>04XX XXX XXX </span>

                            </p>
                        </div>
                    </div>

                    <div *ngIf="userId == messageOwnerId" class="info-item info-row">
                        <div class="info-label">
                            <h4> Mobile</h4>
                        </div>
                        <div class="info-desc">
                            <p *ngIf="messageDetails?.booking_status == 'MD' 
                            || messageDetails?.booking_status == 'M'
                            || messageDetails?.booking_status == 'A'
                            || messageDetails?.booking_status == 'CURR'">
                                <span class="highlight" (click)="makeCall(messageDetails.minder.mobile)">
                                    {{messageDetails?.minder?.mobile}}
                                </span>
                            </p>
                            <p *ngIf="messageDetails?.booking_status == 'E' 
                                || messageDetails?.booking_status == 'C'
                                || messageDetails?.booking_status == 'P'
                                || messageDetails?.booking_status == 'D' 
                                || messageDetails?.booking_status == 'CAN'
                                || messageDetails?.booking_status == 'PP'
                                || messageDetails?.booking_status == 'L'
                                || messageDetails?.booking_status == 'RA'
                                || messageDetails?.booking_status == 'R'
                                || messageDetails?.booking_status == 'J'
                                || messageDetails?.booking_status == 'NA'
                                || messageDetails?.booking_status == 'NC'">
                                <span>04XX XXX XXX </span>
                            </p>

                        </div>
                    </div>



                    <div class="info-item info-row">
                        <div class="info-label">
                            <h4>Service</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{messageDetails?.service?.serviceType?.serviceName}}</p>
                        </div>
                    </div>

                    <div class="info-item info-row">
                        <div class="info-label">
                            <h4>Frequency</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{messageRes?.frequency}}</p>
                        </div>
                    </div>

                    <div class="info-item info-row">
                        <div class="info-label">
                            <h4>Duration</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{messageRes?.duration}}</p>
                        </div>
                    </div>

                    <div class="info-item info-row">
                        <div class="info-label">
                            <h4>Socialisation</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{messageRes?.socialisation}}</p>
                        </div>
                    </div>

                    <div class="info-item info-row">
                        <div class="info-label">
                            <h4>Address</h4>
                        </div>

                        <!-- if booking status = 'MD','CURR' OR (bookings_status = "M"
                         && booking['meetngreet']['acceptedby1'] &&  booking['meetngreet']['acceptedby2'] ) -->
                        <div class="info-desc">
                            <p>{{ (messageDetails?.booking_status == 'MD'|| messageDetails?.booking_status == 'CURR' ||
                                (messageDetails?.booking_status == 'M' &&
                                messageDetails?.meetngreet?.acceptedby1 != '')
                                ) ? (messageDetails?.address_details) : 'Address hidden until
                                booking is confirmed' }}

                            </p>
                        </div>
                    </div>


                    <div *ngIf="pickUpDate" class="info-item info-row">
                        <div class="info-label">
                            <h4>Drop Off</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{pickUpDate}}</p>
                        </div>
                    </div>
                    <div *ngIf="pickEndDate" class="info-item info-row">
                        <div class="info-label">
                            <h4>Pick Up</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{pickEndDate != "" ? pickEndDate : 'No End Date'}}</p>
                        </div>
                    </div>

                    <div *ngIf="pickUpStartTime" class="info-item info-row">
                        <div class="info-label">
                            <h4>Time</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{pickUpStartTime != "" ? pickUpStartTime : '-'}}</p>
                        </div>
                    </div>

                    <div *ngIf="messageDetails?.pickup_address != null" class="info-item info-row">
                        <div class="info-label">
                            <h4>PickUp</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{messageDetails?.pickup_address != null ? messageDetails?.pickup_address : ''}}</p>
                        </div>
                    </div>

                    <div *ngIf="message?.destination_address  != null" class="info-item info-row">
                        <div class="info-label">
                            <h4>Destination</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{messageDetails?.destination_address != null ? messageDetails?.destination_address :
                                ''}}</p>
                        </div>
                    </div>
                    <div class="info-item info-row">
                        <div *ngIf="messageDetails?.days" class="info-label">
                            <h4>Days</h4>
                        </div>
                        <div class="info-desc">
                            <p>{{messageDetails?.days}}</p>
                        </div>
                    </div>
                </div>
                <ion-grid>
                    <ion-row>
                        <ion-col>
                            <h4 class="sub-heading">Pet</h4>
                        </ion-col>
                    </ion-row>
                </ion-grid>

                <div class="pet-list">
                    <div class="pet-box" *ngFor="let pet of messageDetails?.pets" (click)="petDetails(pet)">
                        <ion-avatar slot="start">

                            <ion-img [src]="pet.imagename == '' || pet.imagename == null  ? 
                            'https://dev.petcloud.com.au/img/pet_placeholder.png' 
                            : pet?.imagename"></ion-img>

                        </ion-avatar>
                        <ion-label>{{pet?.name}}</ion-label>
                    </div>
                </div>
                <!-- cost data start -->
                <ion-grid>
                    <ion-row align-items-center>
                        <ion-col>
                            <h4 class="sub-heading">Payment Details</h4>
                        </ion-col>
                        <ion-col class="text-right">
                            <ion-button fill="clear" color="theme" size="small" class="ion-no-padding" *ngIf="!onlyProfile && userId == messageMinderId 
                                && (booking_status == 'P' || booking_status == 'PP' || booking_status == 'J')"
                                (click)="alterBookingCost(messageDetails?.orignal_amount)">
                                <ion-icon name="create"></ion-icon> Edit
                            </ion-button>
                        </ion-col>
                    </ion-row>
                </ion-grid>

                <div class="info-list">

                    <div class="info-item info-row" *ngFor="let serviceDetail of messageDetails?.service?.servicecost">
                        <div class="service-label">
                            <h4>{{serviceDetail?.name}}</h4>
                            <p>${{serviceDetail?.price | number:'1.2-2'}} x {{serviceDetail?.quantity}}</p>
                        </div>
                        <div class="info-desc">
                            <p>${{serviceDetail?.cost | number:'1.2-2'}}</p>
                        </div>
                    </div>
                    <!-- <div class="info-item total-info-item" *ngIf="messageDetails?.service?.donation?.amount">
                        <div class="info-label">
                            <h4 class="fw-600">Donation</h4>
                        </div>
                        <div class="info-desc">
                            <p class="amount">${{messageDetails?.service?.donation?.amount | number:'1.2-2'}}</p>
                        </div>
                    </div> -->
                    <!-- Donation -->
                    <div class="info-item info-row" *ngIf="messageDetails?.booking_fee">
                        <div class="info-label">
                            <h4 class="fw-600">Booking Fee</h4>
                        </div>
                        <div class="info-desc">
                            <p class="amount">${{messageDetails?.booking_fee | number:'1.2-2'}}</p>
                        </div>
                    </div>
                    <!-- Donation -->
                    <div class="info-item info-row" *ngIf="messageDetails?.donation?.amount">
                        <div class="info-label">
                            <h4 class="fw-600">Donation</h4>
                        </div>
                        <div class="info-desc">
                            <p class="amount">${{messageDetails?.donation?.amount | number:'1.2-2'}}</p>
                        </div>
                    </div>

                    <!-- Total -->
                    <div class="info-item info-row" *ngIf="messageDetails?.service?.total">
                        <div class="info-label">
                            <h4 class="fw-600">Total</h4>
                        </div>
                        <div class="info-desc">
                            <p class="amount">${{messageDetails?.service?.total | number:'1.2-2'}}</p>
                        </div>
                    </div>
                </div>

                <div class="button-container" *ngIf="!onlyProfile">
                    <div *ngIf="messageDetails?.booking_status == 'CURR' && messageDetails?.cancel_request_from == null || 
                    messageDetails?.booking_status == 'MD'  && messageDetails?.cancel_request_from == null">
                        <ion-button expand="block" (click)="cancelBooking(messageDetails.id,messageDetails)"
                            color="danger" class="text-capitalize fls-0">Cancel</ion-button>
                    </div>

                    <div *ngIf="messageDetails?.booking_status == 'A'  && messageDetails?.cancel_request_from == null ||
                    messageDetails?.booking_status == 'M' && messageDetails?.cancel_request_from == null">
                        <ion-button expand="block" (click)="declineBooking(messageDetails.id,messageDetails)"
                            color="danger" class="text-capitalize fls-0">Decline</ion-button>
                    </div>

                    <div *ngIf="messageDetails?.booking_status == 'A' || 
                    messageDetails?.booking_status == 'M' || 
                    messageDetails?.booking_status == 'MD' || 
                    messageDetails?.booking_status == 'CURR' ">
                        <ion-button expand="block" (click)="modifyBooking(messageDetails.id)" color="theme-sec"
                            class="text-capitalize fls-0">Modify</ion-button>
                    </div>
                </div>
                <div class="button-container profile-btn" *ngIf="onlyProfile">
                    <div
                        *ngIf="messageDetails?.cancel_request_from == null && (booking_status == 'MD' || booking_status == 'CURR')">
                        <ion-button expand="block" (click)="cancelBooking(messageDetails.id,messageDetails)"
                            color="danger" class="text-capitalize fls-0">Cancel</ion-button>
                    </div>
                    <div
                        *ngIf="messageDetails?.cancel_request_from == null && (booking_status == 'P' || booking_status == 'PP' || booking_status == 'J')">
                        <ion-button expand="block" (click)="declineBooking(messageDetails.id,messageDetails)"
                            color="danger" class="text-capitalize fls-0">Decline</ion-button>
                    </div>
                    <div *ngIf="userId == messageOwnerId
                        && (booking_status == 'P' || booking_status == 'PP')">
                        <ion-button expand="block" (click)="modifyBooking(messageDetails.id)" color="theme-sec"
                            class="text-capitalize fls-0">Modify</ion-button>
                    </div>
                </div>
            </div>

            <div *ngSwitchCase="'bookingAssistant'">

                <div *ngIf="showCelebrationAnaimation" class="wrapper">
                    <div *ngFor="let data of confetti; let i = index" class="confetti-{{i}}">
                    </div>
                </div>

                <div>
                    <!-- CONDITION IS J -->
                    <div *ngIf="booking_status == 'J' && messageDetails?.messageView == 1">
                        <!-- Onwer Id -->
                        <div *ngIf="userId == messageOwnerId" class="list-status">
                            <div *ngFor="let message of messageDetails?.messages">
                                <ul *ngIf="message?.callToAction == 'BJA'">
                                    <li>
                                        <div class="content">
                                            Post a Job <a (click)="viewJobs()">View Job.</a>
                                        </div>
                                    </li>
                                    <li>
                                        <div>We are glad to connect you both through PetCloud. Your Booking ID is:
                                            {{chatBookingId}}

                                        </div>
                                    </li>

                                    <li class="green-mark">
                                        <div class="content">
                                            {{messageDetails?.minder?.first_name}} has applied for your job. Meeting up
                                            with
                                            this Sitter will free up the other
                                            applicants so they can apply to other jobs.
                                        </div>
                                    </li>
                                </ul>
                            </div>


                            <ion-grid>
                                <ion-row>
                                    <ion-col size="6">
                                        <ion-button expand="block" class="text-capitalize fls-0" color="theme"
                                            (click)="letsMeet('J')">Let's Meet</ion-button>
                                    </ion-col>
                                    <ion-col size="6">
                                        <ion-button expand="block" class="text-capitalize fls-0" color="theme-sec"
                                            (click)="unsuitableBooking()">Unsuitable</ion-button>
                                    </ion-col>
                                </ion-row>
                            </ion-grid>
                        </div>

                        <!-- Minder Id -->
                        <div *ngIf="userId == messageMinderId" class="list-status">
                            <div *ngFor="let message of messageDetails?.messages, let last = last">
                                <ul>
                                    <li *ngIf="message?.callToAction == 'BJA'">
                                        <div class="content">
                                            You have applied for a job with {{messageDetails?.owner?.first_name}}.
                                        </div>
                                    </li>


                                    <li [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Awaiting the {{messageDetails?.owner?.first_name}} to accept or decline the
                                            application.
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>

                    </div>


                    <!-- CONDITION IS P -->
                    <div *ngIf="booking_status == 'P' && messageDetails?.messageView == 1">
                        <!-- Onwer Id -->
                        <div *ngIf="userId == messageOwnerId" class="list-status">
                            <div *ngFor="let message of messageDetails?.messages">
                                <ul *ngIf="message?.callToAction == 'BRE'">
                                    <li class="green-mark">
                                        <div class="content">
                                            Booking Request to {{messageDetails?.minder?.first_name}}
                                        </div>
                                        <div class="support-content">
                                            <ion-button expand="block" (click)="deleteBooking()" color="danger"
                                                class="text-capitalize fls-0">Cancel Enquiry</ion-button>
                                        </div>
                                        <div class="support-content">
                                            <h6> Waiting on {{messageDetails?.minder?.first_name}} to accept your
                                                enquiry
                                            </h6>
                                            <h6>Tip: The ⚡ fastest way to connect with available Sitters is to <a
                                                    (click)="postJob()">Post a
                                                    Job</a>.
                                                This sends out an alert in a 25km radius & available Sitters will apply!
                                            </h6>
                                        </div>
                                    </li>
                                </ul>

                            </div>
                        </div>


                        <!-- Minder Id -->
                        <div *ngIf="userId == messageMinderId" class="list-status">
                            <div *ngFor="let message of messageDetails?.messages">
                                <ul *ngIf="message?.callToAction == 'BRE'">
                                    <li class="green-mark">
                                        <div class="content">
                                            Booking Request from {{messageDetails?.owner?.first_name}}.
                                        </div>
                                        <div class="support-content">
                                            <h6>{{messageDetails?.owner?.first_name}} has enquired about your
                                                availability
                                                for a booking.
                                                If you accept, the booking will be confirmed once
                                                {{messageDetails?.owner?.first_name}} has made a payment.</h6>
                                        </div>
                                        <div class="button-container">
                                            <ion-button expand="block" class="custom-long-text-button aqua-button "
                                                color="primary" (click)="acceptOrCancelBooking(1)">YES. I am interested
                                                to do this
                                                booking</ion-button>
                                            <ion-button expand="block" class="custom-long-text-button outline-button"
                                                (click)="acceptOrCancelBooking(0)" color="light">No I can't accomodate
                                                this
                                                booking</ion-button>
                                        </div>
                                        <div *ngIf="showHideMeetGreetButton">

                                            <!-- <ion-card *ngIf="iswalletCheckBalanceboxUnChecked">
                                                <ion-card-content>
                                                    <p style="color: red;"> Please agree to the below by checking the
                                                        boxes
                                                    </p>
                                                </ion-card-content>
                                            </ion-card> -->

                                            <div>
                                                <ion-checkbox color="primary" [ngModel]="isNumberShare"
                                                    (ionChange)="shareNo($event)" checked slot="start"></ion-checkbox>
                                                <ion-label style="padding: 5px;
                                                margin: 3px;">Share my number with
                                                    {{messageDetails?.owner?.first_name}}:
                                                    {{messageDetails?.minder?.mobile}}</ion-label>
                                            </div>

                                            <div>
                                                <ion-checkbox [ngModel]="isCheckedTC" color="primary"
                                                    (ionChange)="agreeTC($event)" checked slot="start"></ion-checkbox>
                                                <ion-label style="padding: 5px;
                                                margin: 3px;">I agree to not ever accept any cash payments outside of
                                                    PetCloud,
                                                    by {{messageDetails?.owner?.first_name}}.
                                                    I understand that 19% of this transaction is essential to further
                                                    development of this website,
                                                    & towards supporting RSPCA Partners to rescue abandoned, abused, &
                                                    neglected pets.</ion-label>
                                            </div>

                                            <ion-row>
                                                <ion-col>
                                                    <ion-button expand="block" class="text-capitalize fls-0"
                                                        color="success" (click)="letsMeet('P')">Agree Meet & Greet
                                                    </ion-button>
                                                </ion-col>
                                            </ion-row>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- CONDITION IS MD  or M-->
                    <div *ngIf="booking_status == 'MD' ||  booking_status == 'M' 
                     ||  booking_status == 'C' 
                    || booking_status == 'A' ||  booking_status == 'CURR' || booking_status == 'D' 
                    || booking_status == 'E' || booking_status == 'PP' 
                    && messageDetails?.messageView == 1">

                        <div class="list-status">

                            <div *ngIf="messageOwnerId == userId">
                                <ul *ngFor="let message of messageDetails?.messages; let last = last; let i = index">
                                    <!-- BJA -->
                                    <li *ngIf="message.callToAction == 'addCard'">
                                        <div class="content">
                                            Connect your card. <a routerLink="/payment-method"> View Payment
                                                Methods.</a>
                                        </div>
                                    </li>

                                    <li *ngIf="message.callToAction == 'BJA'">
                                        <div class="content">
                                            Post a Job <a (click)="viewJobs()">View Job.</a>
                                        </div>
                                    </li>
                                    <li *ngIf="message.callToAction == 'BJA'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Select a Sitter from <a (click)="viewJobs()">Applicants.</a>
                                        </div>
                                    </li>

                                    <li *ngIf="message.callToAction == 'BJA'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <h6> {{messageDetails?.minder?.first_name}} has applied for your job.
                                                Meeting up
                                                with this Sitter will free up the other applicants so they can apply to
                                                other jobs.</h6>

                                        </div>
                                    </li>

                                    <!-- BRE -->
                                    <li *ngIf="message.callToAction == 'BRE'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Booking Request to {{messageDetails?.minder?.first_name}}
                                        </div>

                                    </li>

                                    <li *ngIf="message.callToAction == 'BRE'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Booking Request from {{messageDetails?.owner?.first_name}} accepted by
                                            {{messageDetails?.minder?.first_name}}.
                                        </div>
                                    </li>

                                    <!-- JA -->

                                    <li *ngIf="message.callToAction == 'JA' || message.callToAction == 'BA'"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            PreAuthorise Your booking charge.
                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>

                                                <div class="support-content">
                                                    <!-- <p [hidden]="!messageDetails?.jobId" >Congrats! You have Accepted
                                                        Application from
                                                        {{messageDetails?.minder?.first_name}} for your job.</p>  -->
                                                    <!-- <p  [hidden]="messageDetails?.jobId" > Congrats! The  {{messageDetails?.minder?.first_name}} has indicated they are available for those dates. </p>  -->
                                                </div>

                                                <p *ngIf="available_balance < chargeAmount">
                                                    Show the Sitter you’re serious by funding your PetCloud wallet.
                                                    Funds will not be released to the Sitter until after the stay.<br>
                                                    If the Sitter is not a good match, you can cancel the booking.<br>
                                                    Book faster & top up less often by having plenty of credits in your
                                                    wallet, <br>
                                                    Get a refund anytime read <span
                                                        (click)="openBrowser('https://dev.petcloud.com.au/terms-of-service')"
                                                        class="highlight"> T&Cs </span>
                                                </p>

                                                <p *ngIf="available_balance >= chargeAmount">
                                                    Congrats! {{messageDetails?.minder?.first_name}} is available for
                                                    the dates you inquired.<br>
                                                    Arrange a Meet & Greet within the next 7 days.
                                                </p>
                                            </div>
                                        </div>


                                        <ion-grid [style.display]="isPreAuthBlock == true ? 'block' : 'none'" *ngIf="messageDetails?.minder?.paypal_email == '' &&
                                        messageDetails?.minder?.paypal_email == null ||
                                         messageDetails?.minder?.stripeConnectId == ''&&
                                        messageDetails?.minder?.stripeConnectId == null ||
                                        messageDetails?.minder?.stripeConnectId == null &&
                                                messageDetails?.minder?.paypal_email == null">
                                            <!-- <h6 *ngIf="messageDetails?.wallet_booking == '1'" style="color: red;">
                                                Note: Please use your Wallet to authorise this booking.</h6> -->
                                            <h6 *ngIf="messageDetails?.minder?.paypal_email == '' &&
                                            messageDetails?.minder?.paypal_email == null
                                            " style="color: red;"> Note: The
                                                sitter's preferred method of payment is Stripe,
                                                Please use your Visa, Mastercard or Amex to authorise this booking.</h6>

                                            <h6 *ngIf="messageDetails?.minder?.stripeConnectId == ''&&
                                                    messageDetails?.minder?.stripeConnectId == null"
                                                style="color: red;">
                                                The
                                                sitter's preferred method of payment is PayPal,
                                                Please use PayPal to authorise this booking.</h6>

                                            <h6 *ngIf="messageDetails?.minder?.stripeConnectId == null &&
                                                messageDetails?.minder?.paypal_email == null" style="color: red;">
                                                Note: The sitter's has no preferred method of payment.
                                            </h6>
                                        </ion-grid>


                                        <ion-row *ngIf='isPreAuthBlock == true'>
                                            <ion-col *ngIf="messageDetails?.minder?.stripeConnectId != null &&
                                                    messageDetails?.messageView != '1' ">
                                                <ion-button expand="block" class="text-capitalize fls-0" color="theme"
                                                    (click)="authorizeCard()">PreAuthorise & Open Live
                                                    Chat
                                                </ion-button>
                                            </ion-col>

                                            <ion-col *ngIf="messageDetails?.minder?.paypal_email != null && 
                                                    messageDetails?.messageView != '1' ">
                                                <ion-button expand="block" class="text-capitalize fls-0" color="theme"
                                                    (click)="paypalAuth(messageDetails?.service?.total,messageDetails?.id)">
                                                    PreAuthorise & Open Live Chat
                                                </ion-button>
                                            </ion-col>

                                            <ion-col
                                                *ngIf="messageDetails?.messageView == '1' && booking_status == 'PP' ">

                                                <div class="button-container">

                                                    <ng-container *ngIf="available_balance < chargeAmount">
                                                        <ion-button expand="block"
                                                            class="custom-long-text-button aqua-button" color="theme"
                                                            [disabled]="isWalletAuthorizedButtonClicked"
                                                            (click)="authorizeBookingViaWallet(messageDetails?.id)">
                                                            Add Credits & Enable Live Chat </ion-button>
                                                    </ng-container>

                                                    <ion-button expand="block"
                                                        class="custom-long-text-button aqua-button" color="danger"
                                                        (click)="ownerCancelBooking()">Cancel Booking
                                                    </ion-button>
                                                </div>

                                            </ion-col>
                                        </ion-row>

                                        <ion-row *ngIf="booking_status == 'PP'">
                                            <ion-col>
                                                <h6> Your Wallet will not be charged until you confirm on PetCloud
                                                    that you have met the Sitter & that you are happy to proceed.
                                                    If after meeting you indicate the booking will not proceed,
                                                    this PreAuthorisation will fall off the Wallet.</h6>
                                            </ion-col>
                                        </ion-row>

                                    </li>

                                    <!-- SAF  -->
                                    <li *ngIf="message?.callToAction == 'SAF'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b>
                                                Charge PreAuthorisation failed.
                                            </b>
                                        </div>
                                    </li>

                                    <!-- SCA -->
                                    <li *ngIf="message.callToAction == 'SCA'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <ng-container *ngIf="messageDetails?.wallet_booking == '1'">
                                                Congrats! {{messageDetails?.minder?.first_name}} is available for the
                                                dates you inquired. Arrange a Meet & Greet within the next 7 days.
                                            </ng-container>
                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                Success! Card PreAuthorised (not charged).
                                            </ng-container>
                                        </div>
                                    </li>

                                    <!-- PCA -->
                                    <li *ngIf="message.callToAction == 'PCA'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Success! Paypal Charge PreAuthorised (not charged)
                                        </div>
                                    </li>

                                    <!-- BMA -->
                                    <li *ngIf="message.callToAction == 'BMA'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Arrange a Meet & Greet.
                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <p>
                                                        <!-- Congrats! You have Accepted Application from
                                                        {{messageDetails?.minder?.first_name}} for your job.  -->
                                                        We are
                                                        glad to connect you both through PetCloud.
                                                        Your Booking ID is: {{chatBookingId}}.
                                                    </p>
                                                    <p>
                                                        Please read through the <span (click)="downloadPDF()"
                                                            class="highlight">
                                                            <u> <b>Meet & Greet Guide</b></u></span> in the next 7 days,
                                                        along with your pet.
                                                        This way, you will know quickly whether the Sitter, their
                                                        Property,
                                                        &
                                                        their Pets are going to be suitable for your pet/s and
                                                        is escape-proof & hazard -free. If it turns out it's not going
                                                        to be
                                                        suitable, this gives you time to find an alternate Sitter,
                                                        rather than leaving no alternative options right before you need
                                                        to
                                                        travel.

                                                    </p>
                                                </div>
                                            </div>
                                        </div>


                                        <ion-grid *ngIf="booking_status== 'A' 
                                        && message.callToAction !=  'BSMNGBO'  && message?.noButtons == null">
                                            <ion-row>

                                                <ion-col>
                                                    <ion-button expand="block" class="text-capitalize fls-0"
                                                        color="theme" (click)="meetandGreet(messageDetails?.id,false)">
                                                        Request Meet and
                                                        Greet</ion-button>
                                                </ion-col>

                                                <ion-col>
                                                    <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                        <ion-button expand="block" class="text-capitalize fls-0"
                                                            color="theme-sec" (click)="confrimMyBooking()">Skip & Pay
                                                            Now
                                                        </ion-button>
                                                    </ng-container>

                                                    <ng-container *ngIf="messageDetails?.wallet_booking == '1'">
                                                        <ion-button expand="block" class="text-capitalize fls-0"
                                                            color="theme-sec"
                                                            (click)="walletCheckBalance('confrimMyBooking')">Skip &
                                                            Confirm Now
                                                        </ion-button>
                                                    </ng-container>
                                                </ion-col>

                                            </ion-row>
                                        </ion-grid>

                                    </li>

                                    <!-- BMCA -->
                                    <li *ngIf="message.callToAction == 'BMCA'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Meet & Greet skipped
                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <p>
                                                        We are glad to connect you both through PetCloud. Your Booking
                                                        ID
                                                        is: {{chatBookingId}}.
                                                    </p>
                                                    <p>
                                                        Since there is less than 24 hrs before this booking begins,
                                                        you both must discuss what your alternate options are in the
                                                        event
                                                        that
                                                        any pets are not compatible.
                                                    </p>
                                                    <p>
                                                        Please read through the <span (click)="downloadPDF()"> <u>
                                                                <b>Meet & Greet Guide</b></u> </span> & It is both
                                                        the responsibility of Pet Owners &
                                                        Pet Sitters to ensure the property is escape-proof and
                                                        hazard-free,
                                                        inside and out.
                                                        Pet Owners must provide a Next of Kin Emergency Contact + Vet
                                                        Contact. Pets must be wearing collars with ID tags.
                                                        Enrichment toys & Meaty bones can help guest pets settle, so
                                                        bring
                                                        these along.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BMGS booking->meetngreet->suggested_by == $user->id -->
                                    <li *ngIf="message.callToAction ==  'BMGS' && messageDetails?.meetngreet?.suggested_by != userId"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">

                                            <div class="pet-cloud-support">

                                                <div *ngIf="booking_status != 'M'">
                                                    <div class="pet-cloud-icon">
                                                        <img src="assets/icon/support-icon.png" alt="">
                                                        <span>Pet Cloud</span>
                                                    </div>
                                                    <div class="support-content">
                                                        Meet & Greet Requested by <span>{{messageDetails?.ownerid ==
                                                            messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                            (messageDetails?.minder?.first_name)}} </span>
                                                    </div>
                                                </div>



                                                <div *ngIf="booking_status == 'M'" class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>

                                                <div *ngIf="messageDetails?.meetngreet?.acceptedby2 == null  && booking_status == 'M'  && message?.noButtons == null "
                                                    class="support-content">
                                                    <b> Meet & Greet Requested by

                                                        <span>{{messageDetails?.ownerid ==
                                                            messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                            (messageDetails?.minder?.first_name)}} </span>

                                                    </b>
                                                    <p>Please Confirm,</p>
                                                    <p>
                                                        Do any of these dates & times work for a Meet & Greet?
                                                    </p>

                                                    <p
                                                        *ngIf="messageDetails?.meetngreet?.location == 'petsittershouse'">
                                                        You suggested to meet at Your house:
                                                        <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                messageDetails.meetngreet.lng
                                                )"> {{messageDetails?.meetngreet?.location}}</a>
                                                    </p>

                                                    <p *ngIf="messageDetails?.meetngreet?.location == 'petownershouse'">
                                                        You suggested to meet at {{messageDetails?.owner?.first_name}}
                                                        house:
                                                        <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                    messageDetails.meetngreet.lng
                                                )"> {{messageDetails?.meetngreet?.location}}</a>
                                                    </p>


                                                    <p *ngIf="messageDetails?.meetngreet?.location == 'mutuallocation'">
                                                        You suggested to meet at Mutual Location
                                                        <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                messageDetails.meetngreet.lng
                                                )"> {{messageDetails?.meetngreet?.location}}</a>
                                                    </p>

                                                    <p *ngIf="messageDetails?.meetngreet?.location == 'other'">
                                                        You suggested to meet at Other Location
                                                        <a (click)="googleMap(messageDetails.meetngreet.lat,
                                            messageDetails.meetngreet.lng
                                            )"> {{messageDetails?.meetngreet?.location}}</a>
                                                    </p>


                                                    <ng-container>

                                                        <ion-item
                                                            *ngFor="let date of messageDetails?.meetngreet?.inspection_dates; let i = index"
                                                            class="ion-no-padding">

                                                            <ion-label> {{date.date}} at {{date.time}}</ion-label>
                                                            <ion-radio slot="end" color="theme" [checked]="date.checked"
                                                                (click)="onRadioButtonChecked(messageDetails?.id,i)">
                                                            </ion-radio>
                                                        </ion-item>


                                                        <ng-container>
                                                            <ion-button color="theme"
                                                                (click)="meetandGreetConfrimDates(messageDetails?.id,i)"
                                                                class="text-capitalize fls-0" expand="block">Yes I
                                                                Confirm</ion-button>

                                                            <ion-button (click)="meetandGreet(messageDetails?.id,true)"
                                                                class="custom-long-text-button text-capitalize fls-0"
                                                                color="theme" expand="block">
                                                                Suggest new time
                                                            </ion-button>
                                                        </ng-container>
                                                    </ng-container>
                                                </div>


                                                <ion-grid
                                                    *ngIf="messageDetails?.meetngreet?.acceptedby2 == null  && booking_status == 'M'">
                                                    <p>

                                                        Once you have held a Meet & Greet, we will ask you to let us
                                                        know how it went: Thumbs up,
                                                        your Wallet will be charged / Thumbs down, and the preauth will
                                                        automatically fall off your Wallet &
                                                        you can meet with a more compatible Sitter.
                                                    </p>
                                                    <br>
                                                    <span>
                                                        Already met the Minder and you both agree the booking is going
                                                        ahead?
                                                    </span>
                                                    <ion-row>

                                                        <ion-col>
                                                            <ion-button expand="block"
                                                                (click)="chargeOwner(messageDetails.id)"
                                                                color="theme-sec" class="
                                                            custom-long-text-button
                                                            text-capitalize fls-0">Skip Meeting & Place funds in Escrow
                                                            </ion-button>

                                                        </ion-col>
                                                    </ion-row>
                                                </ion-grid>


                                                <div
                                                    *ngIf="messageDetails?.meetngreet?.acceptedby2 != null  && booking_status == 'M'">

                                                    <div class="support-content">


                                                        <!-- if($booking->ownerid == $booking->meetngreet->suggested_by){
                                                            $suggestedBy = $booking->owner->first_name;
                                                            $waitingtoconfirm = $booking->minder->first_name;
                                                        }elseif($booking->minderId == $booking->meetngreet->suggested_by){
                                                            $suggestedBy = $booking->minder->first_name;
                                                            $waitingtoconfirm = $booking->owner->first_name;
                                                        }else{
                                                            $suggestedBy = $booking->owner->first_name;
                                                            $waitingtoconfirm = $booking->minder->first_name;
                                                        }
                                                        
                                                        if($booking->meetngreet->suggested_by == $user->id){
                                                            $suggestedBy = 'You';
                                                        }
                                                        if($booking->meetngreet->suggested_by != $user->id){
                                                            $waitingtoconfirm = 'You';
                                                        } -->



                                                        <b>Meet & Greet Requested by
                                                            <span>{{messageDetails?.ownerid ==
                                                                messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                                (messageDetails?.minder?.first_name)}}</span></b>
                                                        <p
                                                            *ngIf="messageDetails?.meetngreet?.location == 'petsittershouse'">
                                                            You suggested to meet at Your house:
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                        messageDetails.meetngreet.lng
                                                        )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>

                                                        <p
                                                            *ngIf="messageDetails?.meetngreet?.location == 'petownershouse'">
                                                            You suggested to meet at
                                                            {{messageDetails?.owner?.first_name}} house:
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                            messageDetails.meetngreet.lng
                                                        )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>


                                                        <p
                                                            *ngIf="messageDetails?.meetngreet?.location == 'mutuallocation'">
                                                            You suggested to meet at Mutual Location
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                        messageDetails.meetngreet.lng
                                                        )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>

                                                        <p *ngIf="messageDetails?.meetngreet?.location == 'other'">
                                                            You suggested to meet at Other Location
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                    messageDetails.meetngreet.lng
                                                    )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>



                                                        <ion-row>
                                                            <ion-col>
                                                                <ion-text style="text-align: center"
                                                                    *ngFor="let date of messageDetails?.meetngreet.inspection_dates">
                                                                    <ion-row>
                                                                        <ion-col>
                                                                            {{date.date}} at {{date.time}}
                                                                        </ion-col>
                                                                    </ion-row>
                                                                </ion-text>
                                                            </ion-col>
                                                        </ion-row>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <ion-grid *ngIf="message.callToAction ==  'BMGA'">
                                            <ion-row>
                                                <ion-col size="8">
                                                    if you have met the Owner & you both agree the booking is going
                                                    ahead,then click Charge.
                                                    The funds will go into Escrow.
                                                </ion-col>

                                                <ion-col size="4">
                                                    <ion-button class="text-capitalize fls-0" color="theme"
                                                        (click)="confrimMyBooking()">Charge Owner</ion-button>
                                                </ion-col>
                                            </ion-row>
                                        </ion-grid>
                                    </li>


                                    <!-- BMGS booking->meetngreet->suggested_by != $user->id -->
                                    <li *ngIf="message.callToAction ==  'BMGS' && messageDetails?.meetngreet?.suggested_by == userId"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">

                                            <div *ngIf="booking_status != 'M'" class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    Meet & Greet Requested by

                                                    <span>{{messageDetails?.ownerid ==
                                                        messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                        (messageDetails?.minder?.first_name)}}</span>
                                                </div>
                                            </div>

                                            <div *ngIf="messageDetails?.meetngreet.acceptedby2 == null && booking_status == 'M'"
                                                class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <b>Meet and Greet Request by <span>{{userId ==
                                                            messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                            (userName == messageDetails?.owner?.first_name ? 'You' :
                                                            messageDetails?.minder?.first_name) }} </span></b>

                                                    <div
                                                        *ngIf="messageDetails?.meetngreet.acceptedby2 == null && booking_status == 'M'  && message?.noButtons == null   ">

                                                        <p>Waiting on
                                                            <span>
                                                                {{messageDetails?.minder?.first_name}} </span> to
                                                            confirm.
                                                        </p>

                                                        <p>
                                                            You suggested to meet at {{userId ==
                                                            messageDetails?.meetngreet?.suggested_by ? 'Your' :
                                                            (messageDetails?.minder?.first_name) }}
                                                            house:
                                                            at <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                        messageDetails.meetngreet.lng
                                                        )"> {{messageDetails?.meetngreet?.address}}</a>
                                                        </p>

                                                        <ion-row>
                                                            <ion-col>
                                                                <ion-text style="text-align: center"
                                                                    *ngFor="let date of messageDetails?.meetngreet.inspection_dates">
                                                                    <ion-row>
                                                                        <ion-col>
                                                                            {{date.date}} at {{date.time}}
                                                                        </ion-col>
                                                                    </ion-row>
                                                                </ion-text>
                                                            </ion-col>
                                                        </ion-row>
                                                        <p>
                                                            Once you have held a Meet & Greet, we will ask you to let us
                                                            know
                                                            how it
                                                            went:
                                                            Thumbs up, your
                                                            <ng-container *ngIf="messageDetails?.wallet_booking == '1'">
                                                                Wallet
                                                            </ng-container>

                                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                                card
                                                            </ng-container>
                                                            will be charged / Thumbs down, and the
                                                            preauth
                                                            will
                                                            automatically
                                                            fall off your <ng-container
                                                                *ngIf="messageDetails?.wallet_booking == '1'">
                                                                Wallet
                                                            </ng-container>
                                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                                card
                                                            </ng-container>
                                                            & you can meet with a more compatible Sitter.

                                                            Or, if you prefer, you can meet with a more compatible
                                                            Sitter
                                                        </p>

                                                        <span>
                                                            Already met the Minder and you both agree the booking is
                                                            going ahead?
                                                        </span>

                                                        <ion-grid>
                                                            <ion-row>
                                                                <ion-col *ngIf="messageDetails?.wallet_booking != '1'">
                                                                    <ion-button expand="block"
                                                                        class="text-capitalize fls-0" color="theme"
                                                                        (click)="confrimMyBooking()">Pay
                                                                        Booking
                                                                        Now</ion-button>
                                                                </ion-col>

                                                                <ion-col *ngIf="messageDetails?.wallet_booking == '1'">
                                                                    <ion-button expand="block" class="
                                                                    custom-long-text-button
                                                                    text-capitalize fls-0" color="theme-sec"
                                                                        (click)="walletCheckBalance('confrimMyBooking')">
                                                                        Skip Meeting & Place funds in Escrow
                                                                    </ion-button>
                                                                </ion-col>
                                                            </ion-row>
                                                        </ion-grid>
                                                    </div>
                                                </div>
                                            </div>



                                            <div *ngIf="messageDetails?.meetngreet.acceptedby2 != null && booking_status == 'M'"
                                                class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <b>Meet & Greet Requested by <span>{{messageDetails?.ownerid ==
                                                            messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                            (messageDetails?.minder?.first_name)}}</span></b>
                                                    <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                    messageDetails.meetngreet.lng
                                                    )"> {{messageDetails?.meetngreet?.address}}</a>

                                                    <ion-row>
                                                        <ion-col>
                                                            <ion-text style="text-align: center"
                                                                *ngFor="let date of messageDetails?.meetngreet.inspection_dates">
                                                                <ion-row>
                                                                    <ion-col>
                                                                        {{date.date}} at {{date.time}}
                                                                    </ion-col>
                                                                </ion-row>
                                                            </ion-text>
                                                        </ion-col>
                                                    </ion-row>


                                                    <ion-grid *ngIf="messageDetails?.meetngreet.acceptedby2 == null">
                                                        <ion-row>
                                                            <ion-col>
                                                                <ion-button expand="block" class="text-capitalize fls-0"
                                                                    color="theme" (click)="confrimMyBooking()">Pay
                                                                    Booking
                                                                    Now</ion-button>
                                                            </ion-col>
                                                        </ion-row>
                                                    </ion-grid>
                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BMGA -->
                                    <li *ngIf="message.callToAction ==  'BMGA'"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">

                                            <div *ngIf="booking_status != 'M'" class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>

                                                <div class="support-content">
                                                    <b>
                                                        {{messageDetails?.meetngreet?.accpetmessage}}
                                                        {{ messageDetails?.meetngreet?.msdate }} at
                                                        {{ messageDetails?.meetngreet?.mstime }}
                                                    </b>
                                                </div>

                                            </div>


                                            <div *ngIf="booking_status=='M'" class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>

                                                <!-- empty(booking['meetngreet']['acceptedby2'] && booking['booking_status'] == 'M' -->
                                                <div *ngIf="messageDetails?.meetngreet?.acceptedby2 != null && booking_status == 'M' "
                                                    class="support-content">
                                                    <b>
                                                        Meet & Greet day and time Accepted by
                                                        {{messageDetails?.owner?.first_name}}
                                                        for {{ messageDetails?.meetngreet?.msdate | date:'EEE dd MMM y'
                                                        }} at
                                                        {{ messageDetails?.meetngreet?.mstime }}
                                                    </b>



                                                    <div
                                                        *ngIf="booking_status == 'M'  && message?.noButtons == null   ">


                                                        <!-- booking['md_status_owner'] == {{current_user_id }} && booking['md_status_minder'] == null -->
                                                        <div *ngIf="messageDetails?.md_status_owner != null">
                                                            <p> Great! Waiting on feedback from the other party before
                                                                proceeding.
                                                                Thanks for your response. Once we get the same response
                                                                from
                                                                {{messageDetails?.minder?.first_name}},
                                                                we will proceed with the booking.</p>

                                                        </div>



                                                        <div *ngIf="messageDetails?.meetngreet?.msdate <= currentDate  
                                                        && messageDetails?.md_status_owner == null">
                                                            <b>How did your Meet & Greet go?</b>


                                                            <p
                                                                *ngIf="messageDetails?.jobId == null  || messageDetails?.wallet_booking == '1'">
                                                                If it went well and you'd like to proceed, we'll charge
                                                                owner's
                                                                <span
                                                                    *ngIf="messageDetails?.wallet_booking != '1'">card.</span>
                                                                <span
                                                                    *ngIf="messageDetails?.wallet_booking == '1'">wallet.</span>
                                                                If you felt it wasn't a match, the preauth will drop off
                                                                owner's
                                                                <span
                                                                    *ngIf="messageDetails?.wallet_booking != '1'">card.</span>
                                                                <span
                                                                    *ngIf="messageDetails?.wallet_booking == '1'">wallet.</span>
                                                                and you can
                                                                <a class="highlight" (click)="goToExplore()">request
                                                                    enquiry with the other
                                                                    minders</a>
                                                            </p>



                                                            <ion-card color="note">
                                                                <ion-card-content>
                                                                    How was your meet and greet?
                                                                    <ion-row>
                                                                        <ion-col
                                                                            (click)="meetandGreetNotGreat(message?.id)"
                                                                            class="ion-text-center" size="6">
                                                                            <ion-icon style="zoom: 2;"
                                                                                name="thumbs-down">
                                                                            </ion-icon>
                                                                        </ion-col>

                                                                        <ng-container
                                                                            *ngIf="messageDetails?.wallet_booking != '1'">
                                                                            <ion-col
                                                                                (click)="meetandGreetAwesome(message?.id)"
                                                                                class="ion-text-center" size="6">
                                                                                <ion-icon style="zoom: 2;"
                                                                                    name="thumbs-up">
                                                                                </ion-icon>
                                                                            </ion-col>
                                                                        </ng-container>

                                                                        <ng-container
                                                                            *ngIf="messageDetails?.wallet_booking == '1'">
                                                                            <ion-col
                                                                                (click)="walletCheckBalance('meetGreetAwesome')"
                                                                                class="ion-text-center" size="6">
                                                                                <ion-icon style="zoom: 2;"
                                                                                    name="thumbs-up">
                                                                                </ion-icon>
                                                                            </ion-col>
                                                                        </ng-container>


                                                                        <ion-col
                                                                            (click)="meetandGreetNotGreat(message?.id)"
                                                                            class="ion-text-center" size="6">
                                                                            <ion-label class="fs-12">Not So Great
                                                                            </ion-label>
                                                                        </ion-col>

                                                                        <ng-container
                                                                            *ngIf="messageDetails?.wallet_booking != '1'">
                                                                            <ion-col
                                                                                (click)="meetandGreetAwesome(message?.id)"
                                                                                class="ion-text-center" size="6">
                                                                                <ion-label class="fs-12">Awesome
                                                                                </ion-label>
                                                                            </ion-col>
                                                                        </ng-container>

                                                                        <ng-container
                                                                            *ngIf="messageDetails?.wallet_booking == '1'">
                                                                            <ion-col
                                                                                (click)="walletCheckBalance('meetGreetAwesome')"
                                                                                class="ion-text-center" size="6">
                                                                                <ion-label class="fs-12">Awesome
                                                                                </ion-label>
                                                                            </ion-col>
                                                                        </ng-container>

                                                                    </ion-row>
                                                                </ion-card-content>
                                                            </ion-card>

                                                        </div>


                                                        <p>Click on Skip & Pay Now to confirm booking now </p>

                                                        <ion-row>
                                                            <ion-col *ngIf="messageDetails?.wallet_booking == '1'">
                                                                <ion-button class="text-capitalize fls-0" color="theme"
                                                                    (click)="walletCheckBalance('confrimMyBooking')">
                                                                    Skip & Pay Now
                                                                </ion-button>
                                                            </ion-col>

                                                            <ion-col *ngIf="messageDetails?.wallet_booking != '1'">
                                                                <ion-button class="text-capitalize fls-0" color="theme"
                                                                    (click)="confrimMyBooking()">Skip & Pay Now
                                                                </ion-button>
                                                            </ion-col>

                                                        </ion-row>

                                                    </div>


                                                </div>

                                                <!-- && !message['noButtons'] -->
                                                <div
                                                    *ngIf="messageDetails?.meetngreet?.acceptedby2 == null && booking_status == 'M' && message?.noButtons == null ">

                                                    <b>Click on Pay Booking Now at anypoint.</b>
                                                    <ion-grid>
                                                        <ion-row>
                                                            <ion-col>
                                                                <ion-button color="theme" class="text-capitalize fls-0"
                                                                    expand="block" (click)="addtoCalender()">Add to
                                                                    Calender
                                                                </ion-button>
                                                            </ion-col>
                                                            <ion-col>
                                                                <ion-button color="theme-sec"
                                                                    (click)="confrimMyBooking()"
                                                                    class="text-capitalize fls-0" expand="block">Pay
                                                                    Booking
                                                                    Now</ion-button>
                                                            </ion-col>
                                                        </ion-row>
                                                    </ion-grid>

                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BCDCF -->
                                    <li *ngIf="message?.callToAction == 'BCDCF'"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b>
                                                Preauthrised charge capture failed.
                                            </b>
                                            <p>We tried to charge the pre authorised charged for Booking ID
                                                {{chatBookingId}}
                                                but did not succeed </p>
                                        </div>
                                    </li>

                                    <!-- BMWW -->
                                    <li *ngIf="message.callToAction == 'BMWW'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">

                                            <div class="support-content">
                                                <b>Meet & Greet deemed compatible by both parties.</b>
                                            </div>
                                            <div>
                                                <p class="support-content"> That's great!
                                                    Your <span *ngIf="messageDetails?.wallet_booking != '1'">card
                                                    </span>
                                                    <span *ngIf="messageDetails?.wallet_booking == '1'">Wallet </span>
                                                    has now been charged.
                                                    will sit in escrow until end of stay. This booking is covered by
                                                    PetCloud's Insurance.
                                                </p>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BMWB -->
                                    <li *ngIf="message.callToAction == 'BMWB' "
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> It was not a compatible match by both parties.</b>
                                            <b> Your Preauthorisation will be removed from your
                                                <span *ngIf="messageDetails?.wallet_booking != '1'">card </span>
                                                <span *ngIf="messageDetails?.wallet_booking == '1'">Wallet </span>
                                            </b>
                                        </div>

                                        <hr>

                                        <div *ngFor="let msg of message?.messages" class="content">

                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <p>{{msg?.message}}</p>

                                                </div>
                                            </div>
                                        </div>
                                    </li>


                                    <!-- BSMNG -->
                                    <li *ngIf="message.callToAction == 'BSMNG'"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Meet & Greet Skipped for this booking. </b>
                                        </div>
                                    </li>


                                    <!-- BSMNGBO -->
                                    <li *ngIf="message.callToAction == 'BSMNGBO'"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b>Meet & Greet Skipped by{{messageDetails?.minder?.first_name}}</b>
                                            <p>{{messageDetails?.minder?.first_name}} suggested that you've met
                                                previously,</p>
                                            <p>
                                                Click on <b>Request Meet and Greet or Skip</b> & Pay Now to skip
                                                booking now.
                                            </p>
                                        </div>
                                    </li>

                                    <!-- BCOC -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'BCOC'">
                                        <div class="content">
                                            Booking Confirmed
                                        </div>
                                    </li>

                                    <!-- SCC -->
                                    <li *ngIf="message.callToAction == 'SCC'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                Card PreAuthorised charge captured.
                                            </ng-container>

                                            <ng-container *ngIf="messageDetails?.wallet_booking == '1'">
                                                Booking amount reserved.
                                            </ng-container>


                                        </div>
                                    </li>

                                    <!-- SCF -->
                                    <li *ngIf="message.callToAction == 'SCF'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            PreAuthorised charge capture failed.
                                        </div>
                                    </li>

                                    <!-- PCC -->
                                    <li *ngIf="message.callToAction == 'PCC'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <span *ngIf="messageDetails?.wallet_booking != '1'">Paypal PreAuthorised
                                                charge captured.</span>
                                            <span *ngIf="messageDetails?.wallet_booking == '1'">Wallet PreAuthorised
                                                charge captured.</span>
                                        </div>
                                    </li>

                                    <!-- PCF -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'PCF'">
                                        <div class="content">
                                            <span *ngIf="messageDetails?.wallet_booking != '1'">Paypal PreAuthorised
                                                charge capture failed.</span>
                                            <span *ngIf="messageDetails?.wallet_booking == '1'">Wallet PreAuthorised
                                                charge capture failed</span>
                                        </div>
                                    </li>

                                    <!-- BWTS -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'BWTS'">
                                        <div class="content">
                                            Booking waiting to begin on {{pickUpDate}}
                                        </div>
                                    </li>

                                    <!-- BCTC -->
                                    <li [ngClass]="{'green-mark': last == true}"
                                        *ngIf="message.callToAction == 'BCTC' && booking_status == 'C' ">
                                        <div class="content">

                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <b>Today is the Start of your booked Pet Stay</b>
                                                    <p>Please gather your pet's leashes, poo bags/litter trays,
                                                        belongings,
                                                        food, toys, bedding ina big carry bag
                                                        and drop them off at the Sitters. Or keep them together if the
                                                        Sitter is coming to yours.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BSCTC -->
                                    <li *ngIf="message.callToAction == 'BSCTC'"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Booking has started.
                                        </div>
                                    </li>

                                    <!-- BRCF -->
                                    <li *ngIf="message.callToAction == 'BRCF'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Booking Recurring Charge failed.
                                        </div>
                                    </li>

                                    <!-- BCTCOMP -->
                                    <li [ngClass]="{'green-mark': last == true}"
                                        *ngIf="message.callToAction == 'BCTCOMP' && booking_status == 'C' ">
                                        <div class="content">

                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">

                                                    <!-- Today is the end of the Stay</b> -->

                                                    <p> You are Amazing! Thank you for making an impact by booking
                                                        through PetCloud.</p>

                                                    <ion-button
                                                        *ngIf="messageDetails?.paypal_minder_pay == 1  &&  
                                                        messageDetails?.paypal_minder_paid == null && 
                                                        messageDetails?.bookingType == '1' && 
                                                        messageDetails?.bookingreoccurring?.occurrences < 3
                                                        || messageDetails?.bookingType == '0' &&  messageDetails?.paypal_minder_paid == null"
                                                        expand="block" class="text-capitalize fls-0 fs-12"
                                                        style="white-space: pre-wrap;" color="success"
                                                        (click)="leaveReview()"> Leave a Review & Release Payment
                                                    </ion-button>
                                                </div>


                                                <ion-grid [ngClass]="{'green-mark': last == true}"
                                                    *ngIf="booking_status == 'C'  && message?.noButtons == null">

                                                    <ion-row>
                                                        <ion-col size="12" *ngIf="messageDetails?.bookingReview == false  
                                                        && messageDetails?.paypal_minder_pay == '0' || 
                                                        messageDetails?.paypal_minder_pay == null 
                                                        ">
                                                            <ion-button expand="block"
                                                                class="text-capitalize fls-0 fs-12"
                                                                style="white-space: pre-wrap;" color="theme"
                                                                (click)="leaveReview()">Leave a Review & Release Payment
                                                            </ion-button>
                                                        </ion-col>

                                                        <ion-col size="12"
                                                            *ngIf="messageDetails?.bookingReview == true">
                                                            <ion-button expand="block" class="text-capitalize fls-0"
                                                                color="success">Review Complete</ion-button>
                                                        </ion-col>
                                                    </ion-row>
                                                </ion-grid>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BDRC -->
                                    <li *ngIf="message.callToAction == 'BDRC'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Booking Decline Request Submitted.</b>
                                        </div>
                                    </li>

                                    <!-- BDEC -->
                                    <li *ngIf="message.callToAction == 'BDEC'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Booking Declined.</b>
                                        </div>
                                    </li>

                                    <!-- BAC -->
                                    <li *ngIf="message.callToAction == 'BAC' " [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Booking Cancelled.</b>
                                        </div>
                                    </li>

                                    <!-- BD -->
                                    <li *ngIf="message.callToAction == 'BD' " class="green-mark">
                                        <div class="content">
                                            Booking Declined.
                                        </div>

                                        <div class="support-content">
                                            <h6> Don't stop here. Find other <a (click)="goToExplore()">Pet Sitters</a>
                                            </h6>
                                            <h6>Tip: The ⚡ fastest way to connect with available Sitters is to <a
                                                    (click)="postJob()">Post a
                                                    Job</a>.
                                                This sends out an alert in a 25km radius & available Sitters will apply!
                                            </h6>
                                        </div>
                                    </li>

                                    <!-- BJD -->
                                    <li *ngIf="message.callToAction == 'BJD' " [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Job Application declined.</b>
                                        </div>
                                    </li>

                                    <!-- BE -->
                                    <li *ngIf="message.callToAction == 'BE' " [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Booking Expired.</b>
                                        </div>

                                        <hr>

                                        <div *ngFor="let msg of message?.messages" class="content">

                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <p>{{msg?.message}}</p>

                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- SAC  -->
                                    <li *ngIf="message.callToAction == 'SAC' " [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                <b> Card PreAuthorisation Cancelled.</b>
                                            </ng-container>

                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                <b> Wallet PreAuthorisation Cancelled.</b>
                                            </ng-container>

                                        </div>
                                    </li>

                                    <!-- PAC -->
                                    <li *ngIf="message.callToAction == 'PAC' ">
                                        <div class="content">
                                            <b> Paypal PreAuthorisation Cancelled.</b>
                                        </div>

                                        <hr>

                                        <div *ngFor="let msg of message?.messages" class="content">
                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <p>{{msg?.message}}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>


                            <div *ngIf="messageMinderId == userId">
                                <ul *ngFor="let message of messageDetails?.messages; let last = last; let i = index">
                                    <li *ngIf="message?.callToAction == 'addCard'">
                                        <div class="content">
                                            Connect your <a routerLink="/payout-prefrence"> Payout Preferences.</a>

                                        </div>
                                    </li>

                                    <li *ngIf="message?.callToAction == 'BJA'">
                                        <div class="content">
                                            You have applied for a job with {{messageDetails?.owner?.first_name}}.
                                        </div>
                                    </li>


                                    <li *ngIf="message?.callToAction == 'BJA'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Awaiting the {{messageDetails?.owner?.first_name}} to accept or decline the
                                            application.
                                        </div>
                                    </li>

                                    <li *ngIf="message.callToAction == 'BRE'">
                                        <div class="content">
                                            Booking Request from {{messageDetails?.owner?.first_name}}
                                        </div>
                                    </li>

                                    <li *ngIf="message.callToAction == 'BRE'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Booking Request from {{messageDetails?.owner?.first_name}} accepted by you.
                                        </div>
                                    </li>

                                    <li *ngIf="message.callToAction == 'JA' || message.callToAction == 'BA'"
                                        [ngClass]="{'green-mark': last == true}">

                                        <div *ngIf="messageDetails?.wallet_booking == '1'" class="content">
                                            Tentatively allocating wallet credits against this booking
                                        </div>

                                        <div *ngIf="messageDetails?.wallet_booking != '1'" class="content">
                                            Waiting on {{messageDetails?.owner?.first_name}} to PreAuthorise card
                                        </div>
                                    </li>

                                    <!-- SAF  -->
                                    <li *ngIf="message?.callToAction == 'SAF'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b>
                                                Charge PreAuthorisation failed.
                                            </b>
                                        </div>
                                    </li>

                                    <!-- SCA -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'SCA'">
                                        <div class="content">
                                            <ng-container *ngIf="messageDetails?.wallet_booking == '1'">
                                                Congrats! {{messageDetails?.minder?.first_name}} is available for the
                                                dates you inquired. Arrange a Meet & Greet within the next 7 days.
                                            </ng-container>
                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                Success! Card PreAuthorised (not charged).
                                            </ng-container>
                                        </div>
                                    </li>

                                    <!-- PCA -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'PCA'">
                                        <div class="content">
                                            Success! Paypal Charge PreAuthorised (not charged)
                                        </div>
                                    </li>



                                    <!-- BMA -->
                                    <li *ngIf="message.callToAction == 'BMA'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Arrange a Meet & Greet.
                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <p>
                                                        <!-- Congrats! You have Accepted Application from
                                                        {{messageDetails?.minder?.first_name}} for your job -->
                                                        We are
                                                        glad to connect you both through PetCloud.
                                                        Your Booking ID is: {{chatBookingId}}.
                                                    </p>
                                                    <p>
                                                        Please read through the <span (click)="downloadPDF()"
                                                            class="highlight"><u> <b>Meet & Greet Guide</b></u></span> &
                                                        request a
                                                        Meet
                                                        & Greet in the next 7 days, along with your pet.
                                                        This way, you will know quickly whether the Sitter, their
                                                        Property,
                                                        &
                                                        their Pets are going to be suitable for your pet/s and
                                                        is escape-proof & hazard -free. If it turns out it's not going
                                                        to be
                                                        suitable, this gives you time to find an alternate Sitter,
                                                        rather than leaving no alternative options right before you need
                                                        to
                                                        travel.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>


                                        <!-- && message?.callToAction != 'BSMNGBO' -->
                                        <ion-grid *ngIf="booking_status== 'A'  &&  message?.noButtons == null">
                                            <ion-row>
                                                <ion-col size="12">

                                                    <ion-button expand="block" class="text-capitalize fls-0"
                                                        color="theme" (click)="meetandGreet(messageDetails?.id,false)">
                                                        Request Meet and
                                                        Greet</ion-button>

                                                </ion-col>
                                                <ion-col size="12">
                                                    <ion-button expand="block" class="text-capitalize fls-0"
                                                        color="theme-sec" (click)="chargeOwner(messageDetails?.id)">Skip
                                                        & Confirm Now</ion-button>
                                                </ion-col>
                                            </ion-row>
                                        </ion-grid>
                                    </li>

                                    <!-- BMCA -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'BMCA'">
                                        <div class="content">
                                            Meet & Greet skipped
                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <p>
                                                        We are glad to connect you both through PetCloud. Your Booking
                                                        ID
                                                        is: {{chatBookingId}}.
                                                    </p>
                                                    <p>
                                                        Since there is less than 24 hrs before this booking begins,
                                                        you both must discuss what your alternate options are in the
                                                        event
                                                        that
                                                        any pets are not compatible.
                                                    </p>
                                                    <p>
                                                        Please read through the <span (click)="downloadPDF()"
                                                            class="highlight"><u> <b>Meet & Greet Guide</b></u></span> &
                                                        It is both
                                                        the responsibility of Pet Owners &
                                                        Pet Sitters to ensure the property is escape-proof and
                                                        hazard-free,
                                                        inside and out.
                                                        Pet Owners must provide a Next of Kin Emergency Contact + Vet
                                                        Contact. Pets must be wearing collars with ID tags.
                                                        Enrichment toys & Meaty bones can help guest pets settle, so
                                                        bring
                                                        these along.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BMGS -->

                                    <li *ngIf="message.callToAction ==  'BMGS' && messageDetails?.meetngreet?.suggested_by != userId"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">

                                            <div class="pet-cloud-support">

                                                <div *ngIf="booking_status != 'M'">
                                                    <div class="pet-cloud-icon">
                                                        <img src="assets/icon/support-icon.png" alt="">
                                                        <span>Pet Cloud</span>
                                                    </div>
                                                    <div class="support-content">
                                                        Meet & Greet Requested by {{userId ==
                                                        messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                        (messageDetails?.minder?.first_name) }}
                                                    </div>
                                                </div>


                                                <div *ngIf="booking_status == 'M'" class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>

                                                <div *ngIf="messageDetails?.meetngreet?.acceptedby2 == null  && booking_status == 'M'  && message?.noButtons == null "
                                                    class="support-content">
                                                    <b> Meet & Greet Requested by <span>{{messageDetails?.ownerid ==
                                                            messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                            (messageDetails?.minder?.first_name)}} </span> </b>
                                                    <p>Please Confirm,</p>
                                                    <p>
                                                        Do any of these dates & times work for a Meet & Greet?
                                                    </p>

                                                    <p
                                                        *ngIf="messageDetails?.meetngreet?.location == 'petsittershouse'">
                                                        You suggested to meet at Your house:
                                                        <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                messageDetails.meetngreet.lng
                                                )"> {{messageDetails?.meetngreet?.location}}</a>
                                                    </p>

                                                    <p *ngIf="messageDetails?.meetngreet?.location == 'petownershouse'">
                                                        You suggested to meet at {{messageDetails?.owner?.first_name}}
                                                        house:
                                                        <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                    messageDetails.meetngreet.lng
                                                )"> {{messageDetails?.meetngreet?.location}}</a>
                                                    </p>


                                                    <p *ngIf="messageDetails?.meetngreet?.location == 'mutuallocation'">
                                                        You suggested to meet at Mutual Location
                                                        <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                messageDetails.meetngreet.lng
                                                )"> {{messageDetails?.meetngreet?.location}}</a>
                                                    </p>

                                                    <p *ngIf="messageDetails?.meetngreet?.location == 'other'">
                                                        You suggested to meet at Other Location
                                                        <a (click)="googleMap(messageDetails.meetngreet.lat,
                                            messageDetails.meetngreet.lng
                                            )"> {{messageDetails?.meetngreet?.location}}</a>
                                                    </p>


                                                    <ng-container>

                                                        <ion-item
                                                            *ngFor="let date of messageDetails?.meetngreet?.inspection_dates; let i = index"
                                                            class="ion-no-padding">

                                                            <ion-label> {{date.date}} at {{date.time}}</ion-label>
                                                            <ion-radio slot="end" color="theme" [checked]="date.checked"
                                                                (click)="onRadioButtonChecked(messageDetails?.id,i)">
                                                            </ion-radio>
                                                        </ion-item>


                                                        <ng-container>
                                                            <ion-button color="theme"
                                                                (click)="meetandGreetConfrimDates(messageDetails?.id,i)"
                                                                class="text-capitalize fls-0" expand="block">Yes I
                                                                Confirm</ion-button>



                                                            <ion-button fill="outline"
                                                                (click)="meetandGreet(messageDetails?.id,true)"
                                                                class="custom-long-text-button text-capitalize fls-0"
                                                                color="theme" expand="block">
                                                                Don't see a time that works for you? Suggest a new time
                                                            </ion-button>
                                                        </ng-container>
                                                    </ng-container>
                                                </div>


                                                <ion-grid
                                                    *ngIf="messageDetails?.meetngreet?.acceptedby2 == null  && booking_status == 'M'">
                                                    <span>

                                                        Once you have held a Meet & Greet, we will ask you to let us
                                                        know how it went: Thumbs up, your Wallet will be charged /
                                                        Thumbs down, and the preauth will automatically fall off your
                                                        Wallet & you can meet with a more compatible Sitter.
                                                        <!-- If you have met the Minder & you both agree the booking is going ahead,then click Charge. The funds will go into Escrow  -->
                                                    </span>
                                                    <p>

                                                        Already met the Owner and you both agree the booking is going
                                                        ahead?

                                                    </p>
                                                    <ion-row>

                                                        <ion-col>
                                                            <ion-button expand="block"
                                                                (click)="chargeOwner(messageDetails.id)"
                                                                color="theme-sec" class="
                                                            custom-long-text-button
                                                            text-capitalize fls-0">Skip Meeting & Place funds in Escrow
                                                            </ion-button>

                                                        </ion-col>
                                                    </ion-row>
                                                </ion-grid>


                                                <div
                                                    *ngIf="messageDetails?.meetngreet?.acceptedby2 != null  && booking_status == 'M'">

                                                    <div class="support-content">
                                                        <b>Meet & Greet Requested by
                                                            <span>{{messageDetails?.ownerid ==
                                                                messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                                (messageDetails?.minder?.first_name)}}</span> </b>
                                                        <p
                                                            *ngIf="messageDetails?.meetngreet?.location == 'petsittershouse'">
                                                            You suggested to meet at Your house:
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                            messageDetails.meetngreet.lng
                                                            )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>

                                                        <p
                                                            *ngIf="messageDetails?.meetngreet?.location == 'petownershouse'">
                                                            You suggested to meet at
                                                            {{messageDetails?.owner?.first_name}} house:
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                                messageDetails.meetngreet.lng
                                                            )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>


                                                        <p
                                                            *ngIf="messageDetails?.meetngreet?.location == 'mutuallocation'">
                                                            You suggested to meet at Mutual Location
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                            messageDetails.meetngreet.lng
                                                            )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>

                                                        <p *ngIf="messageDetails?.meetngreet?.location == 'other'">
                                                            You suggested to meet at Other Location
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                        messageDetails.meetngreet.lng
                                                        )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>


                                                        <ion-row>
                                                            <ion-col>
                                                                <ion-text style="text-align: center"
                                                                    *ngFor="let date of messageDetails?.meetngreet.inspection_dates">
                                                                    <ion-row>
                                                                        <ion-col>
                                                                            {{date.date}} at {{date.time}}
                                                                        </ion-col>
                                                                    </ion-row>
                                                                </ion-text>
                                                            </ion-col>
                                                        </ion-row>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <ion-grid *ngIf="message.callToAction ==  'BMGA'">
                                            <ion-row>
                                                <ion-col size="8">
                                                    if you have met the Owner & you both agree the booking is going
                                                    ahead,then click Charge.
                                                    The funds will go into Escrow.
                                                </ion-col>

                                                <ion-col size="4">
                                                    <ion-button class="text-capitalize fls-0" color="theme"
                                                        (click)="confrimMyBooking()">Charge Owner</ion-button>
                                                </ion-col>
                                            </ion-row>
                                        </ion-grid>
                                    </li>


                                    <!-- BMGS booking->meetngreet->suggested_by != $user->id -->
                                    <li *ngIf="message.callToAction ==  'BMGS' && messageDetails?.meetngreet?.suggested_by == userId"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">

                                            <div *ngIf="booking_status != 'M'" class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">

                                                    Meet & Greet Requested by

                                                    <span>{{messageDetails?.ownerid ==
                                                        messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                        (messageDetails?.minder?.first_name)}}</span>

                                                </div>
                                            </div>

                                            <div *ngIf="messageDetails?.meetngreet.acceptedby2 == null && booking_status == 'M'"
                                                class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <b>Meet and Greet Request by

                                                        <span>{{messageDetails?.ownerid ==
                                                            messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                            (messageDetails?.minder?.first_name)}}</span>

                                                    </b>

                                                    <div
                                                        *ngIf="messageDetails?.meetngreet.acceptedby2 == null && booking_status == 'M'  && message?.noButtons == null   ">

                                                        <p>Waiting on {{messageDetails?.owner?.first_name}} to confirm.
                                                        </p>
                                                        <p
                                                            *ngIf="messageDetails?.meetngreet?.location == 'petsittershouse'">
                                                            You suggested to meet at Your house:
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                        messageDetails.meetngreet.lng
                                                        )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>

                                                        <p
                                                            *ngIf="messageDetails?.meetngreet?.location == 'petownershouse'">
                                                            You suggested to meet at
                                                            {{messageDetails?.owner?.first_name}} house:
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                            messageDetails.meetngreet.lng
                                                        )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>


                                                        <p
                                                            *ngIf="messageDetails?.meetngreet?.location == 'mutuallocation'">
                                                            You suggested to meet at Mutual Location
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                        messageDetails.meetngreet.lng
                                                        )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>

                                                        <p *ngIf="messageDetails?.meetngreet?.location == 'other'">
                                                            You suggested to meet at Other Location
                                                            <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                    messageDetails.meetngreet.lng
                                                    )"> {{messageDetails?.meetngreet?.location}}</a>
                                                        </p>


                                                        <ion-row>
                                                            <ion-col>
                                                                <ion-text style="text-align: center"
                                                                    *ngFor="let date of messageDetails?.meetngreet.inspection_dates">
                                                                    <ion-row>
                                                                        <ion-col>
                                                                            {{date.date}} at {{date.time}}
                                                                        </ion-col>
                                                                    </ion-row>
                                                                </ion-text>
                                                            </ion-col>
                                                        </ion-row>
                                                        <span>
                                                            Once you have held a Meet & Greet, we will ask you to let us
                                                            know
                                                            how it
                                                            went:
                                                            Thumbs up, your
                                                            <ng-container *ngIf="messageDetails?.wallet_booking == '1'">
                                                                Wallet
                                                            </ng-container>

                                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                                card
                                                            </ng-container>
                                                            will be charged / Thumbs down, and the
                                                            preauth
                                                            will
                                                            automatically
                                                            fall off your <ng-container
                                                                *ngIf="messageDetails?.wallet_booking == '1'">
                                                                Wallet
                                                            </ng-container>
                                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                                card
                                                            </ng-container>
                                                            & you can meet with a more compatible Sitter.

                                                            Or, if you prefer, you can meet with a more compatible
                                                            Sitter
                                                        </span>

                                                        <span>
                                                            Already met the Minder and you both agree the booking is
                                                            going ahead?
                                                        </span>

                                                        <ion-grid>
                                                            <ion-row>
                                                                <ion-col *ngIf="messageDetails?.wallet_booking != '1'">
                                                                    <ion-button expand="block"
                                                                        class="text-capitalize fls-0" color="theme"
                                                                        (click)="confrimMyBooking()">Pay
                                                                        Booking
                                                                        Now</ion-button>
                                                                </ion-col>

                                                                <ion-col *ngIf="messageDetails?.wallet_booking == '1'">
                                                                    <ion-button expand="block" class="
                                                                        custom-long-text-button
                                                                        text-capitalize fls-0" color="theme-sec"
                                                                        (click)="walletCheckBalance('confrimMyBooking')">
                                                                        Skip Meeting & Place funds in Escrow
                                                                    </ion-button>
                                                                </ion-col>
                                                            </ion-row>
                                                        </ion-grid>
                                                    </div>
                                                </div>
                                            </div>



                                            <div *ngIf="messageDetails?.meetngreet.acceptedby2 != null && booking_status == 'M'"
                                                class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <b>Meet & Greet Requested by

                                                        <span>{{messageDetails?.ownerid ==
                                                            messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                            (messageDetails?.minder?.first_name)}}</span>
                                                    </b>
                                                    <a (click)="googleMap(messageDetails.meetngreet.lat,
                                                        messageDetails.meetngreet.lng
                                                        )"> {{messageDetails?.meetngreet?.address}}</a>

                                                    <ion-row>
                                                        <ion-col>
                                                            <ion-text style="text-align: center"
                                                                *ngFor="let date of messageDetails?.meetngreet.inspection_dates">
                                                                <ion-row>
                                                                    <ion-col>
                                                                        {{date.date}} at {{date.time}}
                                                                    </ion-col>
                                                                </ion-row>
                                                            </ion-text>
                                                        </ion-col>
                                                    </ion-row>


                                                    <ion-grid *ngIf="messageDetails?.meetngreet.acceptedby2 == null">
                                                        <ion-row>
                                                            <ion-col>
                                                                <ion-button expand="block" class="text-capitalize fls-0"
                                                                    color="theme" (click)="confrimMyBooking()">Pay
                                                                    Booking
                                                                    Now</ion-button>
                                                            </ion-col>
                                                        </ion-row>
                                                    </ion-grid>
                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BMGA -->
                                    <li [ngClass]="{'green-mark': last == true}"
                                        *ngIf="message?.callToAction ==  'BMGA'">
                                        <div class="content">

                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>


                                                <div *ngIf="booking_status != 'M' " class="support-content">
                                                    <b>
                                                        Meet & Greet Requested by

                                                        <span>{{messageDetails?.ownerid ==
                                                            messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                            (messageDetails?.minder?.first_name)}}</span>
                                                        for {{ messageDetails?.meetngreet?.msdate | date:'EEE dd MMM y'
                                                        }} at
                                                        {{ messageDetails?.meetngreet?.mstime }}
                                                    </b>
                                                </div>

                                                <div *ngIf="booking_status == 'M' && message?.noButtons == null ">

                                                    <!-- empty(booking['meetngreet']['acceptedby2'] && booking['booking_status'] == 'M' -->
                                                    <div *ngIf="messageDetails?.meetngreet?.acceptedby2 != null 
                                                    && booking_status == 'M' " class="support-content">
                                                        <b>
                                                            Meet & Greet Requested by

                                                            <span>{{messageDetails?.ownerid ==
                                                                messageDetails?.meetngreet?.suggested_by ? 'You' :
                                                                (messageDetails?.minder?.first_name)}}</span>
                                                            for {{ messageDetails?.meetngreet?.msdate | date:'EEE dd MMM
                                                            y'}} at
                                                            {{ messageDetails?.meetngreet?.mstime}}
                                                        </b>



                                                        <!-- booking['md_status_owner'] == {{current_user_id }} && booking['md_status_minder'] == null -->
                                                        <div *ngIf="messageDetails?.md_status_minder != null">
                                                            <p> Great! Waiting on feedback from the other party before
                                                                proceeding.</p>
                                                            <p> Thanks for your response. Once we get the same response
                                                                from
                                                                {{messageDetails?.owner?.first_name}},
                                                                we will proceed with the booking.</p>

                                                        </div>



                                                        <div *ngIf="messageDetails?.meetngreet?.msdate <= currentDate && 
                                                        messageDetails?.md_status_minder == null">
                                                            <b>How did your Meet & Greet go?</b>

                                                            <p>
                                                                If it went well and you'd like to proceed, we'll charge
                                                                owner's
                                                                <span
                                                                    *ngIf="messageDetails?.wallet_booking != '1'">card.</span>
                                                                <span
                                                                    *ngIf="messageDetails?.wallet_booking == '1'">wallet.</span>
                                                                If you felt it wasn't a match, the preauth will drop off
                                                                owner's
                                                                <span *ngIf="messageDetails?.wallet != '1'"> card
                                                                </span>
                                                                <span *ngIf="messageDetails?.wallet == '1'"> wallet
                                                                </span>, and you can
                                                                <a class="higlight" (click)="goToExplore()">If you felt
                                                                    it wasn't a match, you can apply for the jobs</a>
                                                            </p>

                                                            <ion-card color="note">
                                                                <ion-card-content>
                                                                    How was your meet and greet?
                                                                    <ion-row>
                                                                        <ion-col
                                                                            (click)="meetandGreetNotGreat(message?.id)"
                                                                            class="ion-text-center" size="6">
                                                                            <ion-icon style="zoom: 2;"
                                                                                name="thumbs-down">
                                                                            </ion-icon>
                                                                        </ion-col>
                                                                        <ion-col
                                                                            (click)="meetandGreetAwesome(message?.id)"
                                                                            class="ion-text-center" size="6">
                                                                            <ion-icon style="zoom: 2;" name="thumbs-up">
                                                                            </ion-icon>
                                                                        </ion-col>
                                                                        <ion-col
                                                                            (click)="meetandGreetNotGreat(message?.id)"
                                                                            class="ion-text-center" size="6">
                                                                            <ion-label>Not So Great</ion-label>
                                                                        </ion-col>
                                                                        <ion-col
                                                                            (click)="meetandGreetAwesome(message?.id)"
                                                                            class="ion-text-center" size="6">
                                                                            <ion-label>Awesome</ion-label>
                                                                        </ion-col>
                                                                    </ion-row>
                                                                </ion-card-content>
                                                            </ion-card>

                                                        </div>



                                                        <ion-row>
                                                            <ion-col>
                                                                <ion-button class="text-capitalize fls-0" color="theme"
                                                                    (click)="confrimMyBooking()">Skip & Confirm Now
                                                                </ion-button>
                                                            </ion-col>
                                                        </ion-row>
                                                    </div>
                                                </div>

                                                <div
                                                    *ngIf="messageDetails?.meetngreet?.acceptedby2 == null && booking_status == 'M' ">
                                                    <b>Click on Pay Booking Now at anypoint.</b>
                                                    <ion-grid *ngIf="message?.noButtons == null">
                                                        <ion-row>
                                                            <ion-col>
                                                                <ion-button color="theme" class="text-capitalize fls-0"
                                                                    expand="block" (click)="addtoCalender()">Add to
                                                                    Calender
                                                                </ion-button>
                                                            </ion-col>
                                                            <ion-col>
                                                                <ion-button color="theme-sec"
                                                                    (click)="confrimMyBooking()"
                                                                    class="text-capitalize fls-0" expand="block">Pay
                                                                    Booking
                                                                    Now</ion-button>
                                                            </ion-col>
                                                        </ion-row>
                                                    </ion-grid>

                                                </div>


                                            </div>
                                        </div>
                                    </li>

                                    <!-- BCDCF -->
                                    <li *ngIf="message?.callToAction == 'BCDCF'"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b>
                                                Preauthrised charge capture failed.
                                            </b>
                                            <p>We tried to charge the pre authorised charged for Booking ID
                                                {{chatBookingId}}
                                                but did not succeed </p>
                                        </div>
                                    </li>

                                    <!-- BMWW -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'BMWW'">
                                        <div class="content">

                                            <div class="support-content">
                                                <b>Meet & Greet deemed compatible by both parties.</b>
                                            </div>
                                            <div>
                                                <p class="support-content"> That's great! Your
                                                    <span *ngIf="messageDetails?.wallet_booking == '1'">
                                                        wallet
                                                    </span>
                                                    <span *ngIf="messageDetails?.wallet_booking == '1'">
                                                        card
                                                    </span>
                                                    has now been charged.
                                                    will sit in escrow until end of stay. This booking is covered by
                                                    PetCloud's Insurance.
                                                </p>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BMWB -->
                                    <li *ngIf="message.callToAction == 'BMWB' "
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b>It was not a compatible match by both parties.</b>
                                        </div>

                                        <hr>

                                        <div *ngFor="let msg of message?.messages" class="content">

                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <p>{{msg?.message}} + <span (click)="goToExplore()">View
                                                            Sitters/Walkers</span></p>

                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BSMNG -->
                                    <li *ngIf="message.callToAction == 'BSMNG'"
                                        [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Meet & Greet Skipped for this booking. </b>
                                        </div>
                                    </li>


                                    <!-- BSMNGBO -->
                                    <li [ngClass]="{'green-mark': last == true}"
                                        *ngIf="message?.callToAction == 'BSMNGBO'">
                                        <div class="content">

                                            <b>Meet & Greet Skipped by You.</b>

                                        </div>
                                        <div class="support-content">
                                            <p>Thanks for your response. Once we get the same response from
                                                {{messageDetails?.owner?.first_name}},
                                                we will proceed with the booking.</p>
                                        </div>
                                    </li>


                                    <!-- BCOC -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'BCOC'">
                                        <div class="content">
                                            Booking Confirmed
                                        </div>
                                    </li>


                                    <!-- SCC -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'SCC'">
                                        <div class="content">
                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                Card PreAuthorised charge captured.
                                            </ng-container>

                                            <ng-container *ngIf="messageDetails?.wallet_booking == '1'">
                                                Booking amount reserved.
                                            </ng-container>

                                        </div>
                                    </li>

                                    <!-- SCF -->
                                    <li *ngIf="message.callToAction == 'SCF'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            PreAuthorised charge capture failed.
                                        </div>
                                    </li>

                                    <!-- PCC -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'PCC'">
                                        <div class="content">
                                            <span *ngIf="messageDetails?.wallet_booking != '1'">Paypal PreAuthorised
                                                charge captured.</span>
                                            <span *ngIf="messageDetails?.wallet_booking == '1'">Wallet PreAuthorised
                                                charge captured.</span>
                                        </div>
                                    </li>

                                    <!-- PCF -->
                                    <li *ngIf="message.callToAction == 'PCF'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <span *ngIf="messageDetails?.wallet_booking != '1'">Paypal PreAuthorised
                                                charge capture failed.</span>
                                            <span *ngIf="messageDetails?.wallet_booking == '1'">Wallet PreAuthorised
                                                charge capture failed</span>
                                        </div>
                                    </li>

                                    <!-- BTWS -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'BWTS'"
                                        class="green-mark">
                                        <div class="content">
                                            Booking waiting to begin on {{pickUpDate}}
                                        </div>
                                    </li>

                                    <!-- BCTC -->
                                    <li [ngClass]="{'green-mark': last == true}"
                                        *ngIf="message.callToAction == 'BCTC' && booking_status == 'C' ">
                                        <div class="content">

                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <b>Today is the Start of your booked Pet Stay</b>
                                                    <p>Please gather your pet's leashes, poo bags/litter trays,
                                                        belongings,
                                                        food, toys, bedding ina big carry bag
                                                        and drop them off at the Sitters. Or keep them together if the
                                                        Sitter is coming to yours.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BSCTC -->
                                    <li [ngClass]="{'green-mark': last == true}"
                                        *ngIf="message.callToAction == 'BSCTC'">
                                        <div class="content">
                                            Booking has started.
                                        </div>
                                    </li>

                                    <!-- BRCF -->
                                    <li *ngIf="message.callToAction == 'BRCF'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            Booking Recurring Charge failed.
                                        </div>
                                    </li>

                                    <!-- BCTCOMP -->
                                    <li [ngClass]="{'green-mark': last == true}"
                                        *ngIf="message.callToAction == 'BCTCOMP' && booking_status == 'C' ">
                                        <div class="content">

                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <b> You are Amazing! Thank you for helping to take care of this
                                                        Owner’s Pet.</b>
                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- BDRC -->
                                    <li *ngIf="message.callToAction == 'BDRC'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Booking Decline Request Submitted.</b>
                                        </div>
                                    </li>

                                    <!-- BDEC -->
                                    <li *ngIf="message.callToAction == 'BDEC'" [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Booking Declined.</b>
                                        </div>
                                    </li>

                                    <!-- BAC -->
                                    <li *ngIf="message.callToAction == 'BAC' " [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Booking Cancelled.</b>
                                        </div>
                                    </li>

                                    <!-- BD -->
                                    <li *ngIf="message.callToAction == 'BD' " class="green-mark">
                                        <div class="content">
                                            Booking Declined.
                                        </div>

                                        <div class="support-content">

                                            <h6> Don't stop here. Apply other jobs <a (click)="goToExplore()"> View
                                                    Jobs</a>

                                            </h6>

                                        </div>
                                    </li>


                                    <!-- BJD -->
                                    <li [ngClass]="{'green-mark': last == true}" *ngIf="message.callToAction == 'BJD'">
                                        <div class="content">
                                            Job application declined .
                                        </div>
                                    </li>

                                    <!-- BE -->
                                    <li *ngIf="message.callToAction == 'BE' " [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <b> Booking Expired.</b>
                                        </div>

                                        <hr>

                                        <div *ngFor="let msg of message?.messages" class="content">

                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <p>{{msg?.message}}</p>

                                                </div>
                                            </div>
                                        </div>
                                    </li>

                                    <!-- SAC  -->
                                    <li *ngIf="message.callToAction == 'SAC' " [ngClass]="{'green-mark': last == true}">
                                        <div class="content">
                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                <b> Card PreAuthorisation Cancelled.</b>
                                            </ng-container>

                                            <ng-container *ngIf="messageDetails?.wallet_booking != '1'">
                                                <b> Wallet PreAuthorisation Cancelled.</b>
                                            </ng-container>

                                        </div>
                                    </li>

                                    <!-- PAC -->
                                    <li *ngIf="message.callToAction == 'PAC' ">
                                        <div class="content">
                                            <b *ngIf="messageDetails?.wallet_booking == '1'"> Wallet PreAuthorisation
                                                Cancelled.</b>
                                            <b *ngIf="messageDetails?.wallet_booking != '1'"> Paypal PreAuthorisation
                                                Cancelled.</b>

                                        </div>

                                        <hr>

                                        <div *ngFor="let msg of message?.messages" class="content">

                                            <div class="pet-cloud-support">
                                                <div class="pet-cloud-icon">
                                                    <img src="assets/icon/support-icon.png" alt="">
                                                    <span>Pet Cloud</span>
                                                </div>
                                                <div class="support-content">
                                                    <p>{{msg?.message}}</p>

                                                </div>
                                            </div>
                                        </div>
                                    </li>


                                </ul>
                            </div>
                        </div>
                    </div>


                    <div *ngIf="messageDetails?.cancel_request_from != null  &&  messageDetails?.messageView == 1">
                        <ion-card>
                            <ion-card-content>
                                <p> Booking cancellation request has been submitted by
                                    {{messageDetails?.cancel_request_from}} on {{cancel_request}} to PetCloud.</p>
                            </ion-card-content>
                        </ion-card>
                    </div>


                    <div *ngIf="messageDetails?.messageView == null">
                        <!-- Booking Status is E -->
                        <div *ngIf="booking_status == 'E'">
                            <ion-card color="note">
                                <ion-card-content>
                                    <p>Enquiry has expired</p>
                                </ion-card-content>
                            </ion-card>
                        </div>

                        <!-- Booking Status is Refund -->
                        <div *ngIf="booking_status == 'R'">
                            <ion-card color="note">
                                <ion-card-content>
                                    <p>Booking Refunded</p>
                                </ion-card-content>
                            </ion-card>
                        </div>

                        <!-- Booking Completed Modal Status is C -->
                        <div *ngIf="booking_status == 'C'">
                            <ion-card color="note" *ngIf="userId == messageOwnerId">
                                <ion-card-content>
                                    <h4>Your booking is complete!</h4>
                                    How did it go, leave a review or favourite the sitter here
                                    <ion-chip expand="block">
                                        <ion-icon name="heart" color="red"></ion-icon>

                                        <ion-label>Favourite</ion-label>
                                    </ion-chip>
                                </ion-card-content>
                            </ion-card>
                            <ion-grid>
                                <ion-row>
                                    <ion-col size="12" *ngIf="userId == messageOwnerId">
                                        <ion-button expand="block" class="text-capitalize fls-0 fs-10"
                                            style="white-space: pre-wrap;" color="theme" (click)="leaveReview()">Leave a
                                            Review & Release Payment</ion-button>
                                    </ion-col>
                                </ion-row>
                            </ion-grid>

                            <ion-card color="note" *ngIf="userId == messageMinderId">
                                <ion-card-content>
                                    <h4>Your booking is complete!</h4>
                                </ion-card-content>
                            </ion-card>
                        </div>

                        <!-- Cancelled Inquiry Status is D -->
                        <div *ngIf="booking_status == 'D'">
                            <ion-card color="note" *ngIf="messageDetails?.delete_minder == 'Y'  
                                    && messageDetails?.delete_owner == 'N' && userId == messageMinderId">
                                <ion-card-content>
                                    <p>You have thanked {{messageDetails?.owner?.first_name}} for their inquiry, but
                                        stated
                                        you are
                                        unavailable on this occasion.
                                    </p>
                                </ion-card-content>
                            </ion-card>


                            <ion-card color="note"
                                *ngIf="messageDetails?.delete_owner == 'Y'  && messageDetails?.delete_minder == 'N' && userId == messageOwnerId">
                                <ion-card-content>
                                    <p>You have cancelled this enquiry</p>
                                </ion-card-content>
                            </ion-card>


                            <ion-card color="note"
                                *ngIf="messageDetails?.delete_owner == 'Y'  && messageDetails?.delete_minder == 'N' && userId == messageMinderId">
                                <ion-card-content>
                                    <p>Sorry, {{messageDetails?.owner?.first_name}}
                                        can't accommodate this request</p>
                                </ion-card-content>
                            </ion-card>


                            <ion-card color="note" *ngIf="messageDetails?.delete_owner == 'N' 
                                    && messageDetails?.delete_minder == 'Y' && userId == messageOwnerId">
                                <ion-card-content>
                                    <p>Sorry, {{messageDetails?.minder?.first_name}}
                                        can't accommodate this request</p>
                                </ion-card-content>
                            </ion-card>

                            <!-- if delete_owner=Y and minder logged in then minder will show "Sorry, {{message?.minder?.first_name}}
                    can't accommodate this request"
    
                    if delete_owner=Y and owner logged in then owner will show "You have cancelled this enquiry" else if
                    delete_owner=N, owner logged in then owner will show "Sorry, {{message?.minder?.first_name}} can't
                    accommodate this request". -->

                        </div>

                        <!-- Status is CURR -->
                        <div *ngIf="booking_status == 'CURR'">
                            <ion-card color="note">
                                <ion-card-header *ngIf="messageDetails?.decline_request_from != null">
                                    <p>Booking Cancellation Request has been Submitted by
                                        {{messageDetails?.decline_request_from}} on
                                        {{message?.decline_request}} to Pet Cloud</p>
                                </ion-card-header>

                                <ion-card-content>
                                    <ion-label>
                                        <p> Your booking is underway! Time until booking ends:</p>
                                        <div class="time" [innerHTML]="differenceDayCalcualte"></div>
                                    </ion-label>
                                </ion-card-content>
                            </ion-card>
                            <ion-grid>
                                <ion-row>
                                    <ion-col>
                                        <ion-button expand="block" class="text-capitalize fls-0" color="theme"
                                            (click)="addtoCalender()">Add to Calender
                                        </ion-button>
                                    </ion-col>
                                </ion-row>
                            </ion-grid>
                        </div>

                        <!-- Status is MD -->
                        <div *ngIf="booking_status == 'MD'">

                            <!-- and if cancel_request not null and booking_status=CURR , booking_status=MD then show this message. -->
                            <!-- if cancel_request not null and booking_status=CURR , booking_status=MD then show the above
                                message for both owner and minder. -->
                            <ion-card color="note">
                                <ion-card-header *ngIf="messageDetails?.decline_request_from != null">
                                    <p>Booking Cancellation Request has been Submitted by
                                        {{messageDetails?.decline_request_from}} on
                                        {{messageDetails?.decline_request}} to Pet Cloud</p>
                                </ion-card-header>
                                <ion-card-content
                                    *ngIf="messageDetails?.md_status_owner != null && messageDetails?.chargeDate == null || messageDetails?.md_status_owner == null && isMinder == true && messageDetails?.chargeDate == null">
                                    We will now process a payment for this booking on your card so that your booking is
                                    confirmed. A
                                    receipt will be sent to your email address. All bookings are covered with Pet Sitter
                                    Liability
                                    Insurance up to $10M.
                                    Here is a list of what to pack for your pet before your trip away.
                                    Prepare your pet for their stay.
                                    We are always here to support you service@petcloud.com.au or look up our Knowledge
                                    Base
                                    or phone
                                    1300 66 77 85 Monday to Friday 9-5pm.
                                </ion-card-content>
                            </ion-card>

                            <ion-card color="note" *ngIf="message?.md_status_minder != null && isMinder == false ">
                                <ion-card-header *ngIf="message.decline_request_from != null">
                                    <p>Booking Cancellation Request has been Submitted by
                                        {{message?.decline_request_from}}
                                        on
                                        {{message?.decline_request}} to Pet Cloud</p>
                                </ion-card-header>

                                <ion-card-content>
                                    We will now process a payment for this booking on {{message?.owner?.first_name}}
                                    card so
                                    that
                                    your booking is
                                    confirmed .
                                    We will send the Owner a list of what to pack for their Pet and how to prepare their
                                    Pet.
                                    Our inbox is monitored all of the time. Please ensure you know where your Emergency
                                    Vet
                                    is
                                    located & the Owner has provided an Emergency contact number of a next of kin in
                                    case of
                                    Emergency. Our email is service@petcloud.com.au Phone number is 1300 66 77 85 Monday
                                    to
                                    Friday
                                    8am to 8pm AEST.
                                </ion-card-content>
                            </ion-card>


                            <ion-card color="note" *ngIf="message?.chargeDate != null">
                                <ion-card-content>
                                    <ion-label>
                                        <p>Your booking is good to go! Time until booking starts:</p>
                                        <div class="time" [innerHTML]="differenceDayCalcualte"></div>
                                    </ion-label>
                                </ion-card-content>
                            </ion-card>
                            <ion-grid>
                                <ion-row *ngIf="message?.chargeDate != null ">
                                    <ion-col>
                                        <ion-button expand="block" class="text-capitalize fls-0" color="theme"
                                            (click)="addtoCalender()">Add to Calender
                                        </ion-button>
                                    </ion-col>
                                </ion-row>
                            </ion-grid>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </ng-container>
</ion-content>

<ion-footer *ngIf="!onlyProfile && isAPILoaded">

    <!-- <ng-container *ngIf="
    booking_status == 'PP' && decline_request == null && chargeAmount <= available_balance ||
    booking_status == 'PP' && decline_request == null && chargeAmount <= available_balance ||
    booking_status == 'A' && decline_request == null ||
    booking_status == 'A' &&  cancel_request == null ||
    booking_status == 'CURR'&& decline_request  == null ||
    booking_status == 'CURR' && cancel_request == null ||
    booking_status == 'MD'&& cancel_request == null ||
    booking_status == 'MD' && decline_request == null 
    || booking_status =='M' && cancel_request == null 
    || booking_status =='M'&& decline_request == null"> -->

    <ion-button class="live-chat" expand="full" (click)="chatScreen()">
        Live Chat
    </ion-button>

    <div class="policy">
        <span>
            We scan messages to enforce policies.
            Booking through PetCloud protects your wallet from unexpected Vet Bills. Asking the other party to complete
            a transaction outside of PetCloud is not allowed.
        </span>
    </div>

    <!-- </ng-container> -->

</ion-footer>